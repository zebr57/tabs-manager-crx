import{d as U,r as C,o as q,a as r,b as y,c as V,e as s,w as i,f as O,u as N,i as E,F as D,g as J,h as I,n as A,t as Q,E as W,j as z,k as M,l as j,_ as G,m as R,p as H,q as K,v as B,s as F,x as te,y as le,z as ne,A as P}from"./popup-6e73cbf0.js";import"./modulepreload-polyfill-3cfb730f.js";const se={class:"quick-operation-container"},ce={class:"form-box"},ae={class:"form-title"},ie={class:"form-color"},re={class:"color-box"},ue=["onClick"],de={class:"form-btn"},pe=U({__name:"QuickOperation",props:{tabsList:{type:Array,required:!0,default:[]},groupArr:{type:Array,required:!0,default:[]}},setup(S){const u=C([]),a=C(0),h=["grey","blue","red","yellow","green","pink","purple","cyan"];let v=C(""),g=C(!0);q(()=>{chrome.storage.sync.get(["isAuto"],function(c){g.value=c.isAuto})});const w=async()=>{chrome.runtime.sendMessage({action:"autoGroup"})},b=()=>{chrome.storage.sync.set({isAuto:g.value},function(){})},d=c=>{a.value=c},_=async()=>{if(u.value.length>0){const c=Q(u.value),l=v.value,f=await chrome.tabs.group({tabIds:c});await chrome.tabGroups.update(f,{title:l}),u.value=[],a.value=0}else W({message:"请勾选标签页~",type:"warning"})};return(c,l)=>{const f=r("el-button"),k=r("el-switch"),e=r("el-divider"),t=r("el-checkbox"),n=r("el-checkbox-group"),x=r("el-input"),L=r("el-popover");return y(),V("div",se,[s(f,{type:"primary",size:"small",onClick:w,style:{"margin-right":"12px"}},{default:i(()=>[O("一键生成分组")]),_:1}),s(k,{modelValue:N(g),"onUpdate:modelValue":l[0]||(l[0]=o=>E(g)?g.value=o:g=o),size:"large","inline-prompt":"",style:{"--el-switch-on-color":"#13ce66","--el-switch-off-color":"#ff4949"},"active-text":"开启自动分组","inactive-text":"关闭自动分组",onChange:b},null,8,["modelValue"]),s(e,{direction:"horizontal","content-position":"left"},{default:i(()=>[O("当前窗口所有标签页")]),_:1}),s(n,{modelValue:u.value,"onUpdate:modelValue":l[1]||(l[1]=o=>u.value=o),size:"normal"},{default:i(()=>[(y(!0),V(D,null,J(S.tabsList,o=>(y(),z(t,{key:o.id,label:o.id},{default:i(()=>[O(M(o.title),1)]),_:2},1032,["label"]))),128))]),_:1},8,["modelValue"]),I("div",ce,[I("div",ae,[s(x,{modelValue:N(v),"onUpdate:modelValue":l[2]||(l[2]=o=>E(v)?v.value=o:v=o),placeholder:"请输入分组名",size:"small",clearable:""},null,8,["modelValue"])]),I("div",ie,[s(L,{placement:"bottom",width:230,trigger:"click"},{reference:i(()=>[I("div",{class:"color-check",style:A({backgroundColor:h[a.value]})},null,4)]),default:i(()=>[I("div",re,[(y(),V(D,null,J(h,(o,p)=>I("span",{key:o,style:A({backgroundColor:o}),class:j([p==a.value?"color-active":"","color-item"]),onClick:$=>d(p)},null,14,ue)),64))])]),_:1})]),I("div",de,[s(f,{type:"primary",size:"small",onClick:_},{default:i(()=>[O("生成分组")]),_:1})])])])}}});const _e=G(pe,[["__scopeId","data-v-8b26d802"]]),me=S=>(te("data-v-ea4d42c9"),S=S(),le(),S),he={class:"current-tabs-container"},fe=me(()=>I("div",{class:"title-h4"},"当前所有标签",-1)),ve={class:"custom-tree-node"},ge={class:"node-left"},be=["src"],ye=["onClick"],ke={class:"node-right"},xe=U({__name:"CurrentTabs",setup(S){let u=C([]),a=C(0),h=C("");const v={children:"children",label:"title"};q(async()=>{k()});const g=e=>{a.value=0,h.value="",e.isRootNode||chrome.tabs.update(e.id,{active:!0})},w=e=>{chrome.tabGroups.update(e.id,{title:e.title},()=>{a.value=0})},b=e=>{h.value=e.title||"未命名",a.value=e.id,e.isRootNode||chrome.tabs.update(e.id,{active:!0})},d=e=>{e.isRootNode&&(e.collapsed=!e.collapsed,chrome.tabGroups.update(e.groupId,{collapsed:e.collapsed}))},_=e=>{if(e.isRootNode)chrome.windows.create({focused:!0},t=>{e.children&&t&&(chrome.tabGroups.move(e.groupId,{windowId:t.id,index:-1}),chrome.tabs.query({windowId:t.id},n=>{var p;const x=(p=e.children)==null?void 0:p.map($=>$.id),o=n.filter($=>!x.includes($.id)).map($=>$.id);chrome.tabs.remove(o)}))});else{const t=e.id;chrome.windows.create({tabId:t})}k()},c=e=>{const t={url:"chrome://newtab/",active:!1};chrome.tabs.create(t,n=>{chrome.tabs.group({tabIds:n.id,groupId:e.groupId}),chrome.tabs.update(n.id,{active:!0})})},l=e=>{chrome.storage.sync.get(["snapshotLogList"],function(t){let n=t.snapshotLogList?JSON.parse(t.snapshotLogList):[];n.push(e),chrome.storage.sync.set({snapshotLogList:JSON.stringify(n)},function(){ne({title:"保存快照成功",type:"success"})})})},f=(e,t)=>{const n=e.parent,x=n.data.children||n.data,L=x.findIndex(o=>o.id===t.id);x.splice(L,1),u.value=[...u.value],t.isRootNode?chrome.tabs.query({groupId:t.groupId},o=>{const p=o.map($=>$.id);chrome.tabs.remove(p)}):chrome.tabs.remove(t.id)},k=()=>{u.value=[],chrome.tabs.query({currentWindow:!0},e=>{e.forEach(t=>{const n={id:t.id,title:t.title||"",url:t.url,favIconUrl:t.favIconUrl,groupId:t.groupId,index:t.index,children:[]};u.value.push(n)}),chrome.tabGroups.query({},t=>{u.value.forEach(n=>{const x=t.find(L=>L.id===n.groupId);x&&(n.groupName=x.title,n.color=x.color,n.collapsed=x.collapsed)}),t.forEach(n=>{const x=u.value.findIndex(p=>p.groupId==n.id),L=u.value.filter(p=>p.groupId==n.id);u.value=u.value.filter(p=>p.groupId!=n.id);const o={id:n.id,title:n.title||"",url:"",color:n.color,groupId:n.id,collapsed:n.collapsed,children:L,isRootNode:!0,isInput:!1};u.value.splice(x,0,o)}),console.log(u.value,"xxxx标签树🌲xxxx")})})};return(e,t)=>{const n=r("el-input"),x=r("Expand"),L=r("Fold"),o=r("el-icon"),p=r("el-tooltip"),$=r("TopRight"),X=r("Plus"),Y=r("Camera"),Z=r("Close"),ee=r("el-tree");return y(),V("div",he,[fe,s(ee,{data:N(u),props:v,"node-key":"id","default-expand-all":"",onNodeClick:g},{default:i(({node:oe,data:m})=>[I("div",ve,[I("div",ge,[m.favIconUrl?(y(),V("img",{key:0,src:m.favIconUrl,class:"icon-img"},null,8,be)):(y(),V("span",{key:1,class:"icon-img",style:A({backgroundColor:m.color})},null,4)),m.isRootNode&&N(a)==m.id?(y(),z(n,{key:2,modelValue:m.title,"onUpdate:modelValue":T=>m.title=T,placeholder:"请输入标题",size:"small",style:{width:"200px"},onClick:R(()=>{},["stop"]),onKeydown:H(T=>w(m),["enter"])},null,8,["modelValue","onUpdate:modelValue","onClick","onKeydown"])):(y(),V("span",{key:3,class:j(["title-box",{"group-title":m.isRootNode}]),style:A({fontWeight:m.isRootNode?600:400}),onClick:R(T=>b(m),["stop"])},M(m.title||"未命名"),15,ye))]),I("div",ke,[m.isRootNode?(y(),z(p,{key:0,class:"box-item",effect:"dark",content:"折叠|展开",placement:"top"},{default:i(()=>[s(o,{size:18,onClick:R(T=>d(m),["stop"])},{default:i(()=>[K(s(x,null,null,512),[[B,!m.collapsed]]),K(s(L,null,null,512),[[B,m.collapsed]])]),_:2},1032,["onClick"])]),_:2},1024)):F("",!0),s(p,{class:"box-item",effect:"dark",content:"移至新窗口",placement:"top"},{default:i(()=>[s(o,{size:18,onClick:R(T=>_(m),["stop"])},{default:i(()=>[s($)]),_:2},1032,["onClick"])]),_:2},1024),m.isRootNode?(y(),z(p,{key:1,class:"box-item",effect:"dark",content:"添加新标签",placement:"top"},{default:i(()=>[s(o,{size:18,onClick:R(T=>c(m),["stop"])},{default:i(()=>[s(X)]),_:2},1032,["onClick"])]),_:2},1024)):F("",!0),s(p,{class:"box-item",effect:"dark",content:"保存快照",placement:"top"},{default:i(()=>[s(o,{size:18,onClick:R(T=>l(m),["stop"])},{default:i(()=>[s(Y)]),_:2},1032,["onClick"])]),_:2},1024),s(p,{class:"box-item",effect:"dark",content:"关闭标签",placement:"top"},{default:i(()=>[s(o,{size:18,onClick:R(T=>f(oe,m),["stop"])},{default:i(()=>[s(Z)]),_:2},1032,["onClick"])]),_:2},1024)])])]),_:1},8,["data"])])}}});const Ce=G(xe,[["__scopeId","data-v-ea4d42c9"]]),Ie={class:"current-tabs-container"},we={class:"custom-tree-node"},Le={class:"node-left"},Ve=["src"],Ne=["onClick"],$e={class:"node-right"},Re=U({__name:"SnapshotLog",setup(S){let u=C("RefTree"),a=C([]),h=C(""),v=C(0);const g={children:"children",label:"title"};q(()=>{chrome.storage.sync.get(["snapshotLogList"],function(l){a.value=l.snapshotLogList?JSON.parse(l.snapshotLogList):[]}),chrome.storage.onChanged.addListener(function(l,f){for(let[k,{oldValue:e,newValue:t}]of Object.entries(l))k=="snapshotLogList"&&(a.value=t?JSON.parse(t):[]),console.log(`Storage key "${k}" in namespace "${f}" changed.`,`Old value was "${e}", new value is "${t}".`)})});const w=async l=>{if(v.value=0,h.value="",l.isRootNode&&l.children&&l.children.length!=0){const f=l.children;f.forEach((k,e)=>{chrome.tabs.create({url:k.url,active:!1},function(t){chrome.runtime.sendMessage({action:"createGroup",tab:t,isLast:e==f.length-1})})})}else chrome.tabs.create({url:l.url})},b=l=>{console.log("修改标题成功",l),c()},d=l=>{h.value=l.title||"未命名",v.value=l.id},_=(l,f)=>{const k=l.parent,e=k.data.children||k.data,t=e.findIndex(n=>n.id===f.id);e.splice(t,1),e.length==0?a.value=a.value.filter(n=>n.children&&n.children.length>0):a.value=[...a.value],c()},c=()=>{let l=Q(a.value)||[];chrome.storage.sync.set({snapshotLogList:JSON.stringify(l)},function(){console.log("修改本地存储snapshotLogList成功")})};return(l,f)=>{const k=r("el-input"),e=r("Delete"),t=r("el-icon"),n=r("el-tooltip"),x=r("el-tree");return y(),V("div",Ie,[s(x,{ref_key:"RefTree",ref:u,data:N(a),props:g,"node-key":"id","default-expand-all":"",onNodeClick:w},{default:i(({node:L,data:o})=>[I("div",we,[I("div",Le,[o.favIconUrl?(y(),V("img",{key:0,src:o.favIconUrl,class:"icon-img"},null,8,Ve)):(y(),V("span",{key:1,class:"icon-img",style:A({backgroundColor:o.color})},null,4)),o.isRootNode&&N(v)==o.id?(y(),z(k,{key:2,modelValue:o.title,"onUpdate:modelValue":p=>o.title=p,placeholder:"请输入标题",size:"small",style:{width:"200px"},onClick:R(()=>{},["stop"]),onKeydown:H(p=>b(o),["enter"])},null,8,["modelValue","onUpdate:modelValue","onClick","onKeydown"])):(y(),V("span",{key:3,class:j(["title-box",{"group-title":o.isRootNode}]),style:A({fontWeight:o.isRootNode?600:400}),onClick:R(p=>d(o),["stop"])},M(o.title||"未命名"),15,Ne))]),I("div",$e,[s(n,{class:"box-item",effect:"dark",content:"删除",placement:"top"},{default:i(()=>[s(t,{size:18,onClick:R(p=>_(L,o),["stop"])},{default:i(()=>[s(e)]),_:2},1032,["onClick"])]),_:2},1024)])])]),_:1},8,["data"])])}}});const Se=G(Re,[["__scopeId","data-v-74636e68"]]),Te={class:"matching-rule-container"},ze=U({__name:"MatchingRule",setup(S){const u=new RegExp("https://(.*?)/");let a=C(""),h=C("");const v=async()=>{var f,k;const w=await chrome.tabs.query({currentWindow:!0}),b=await g(),d=a.value||((k=(f=b==null?void 0:b.url)==null?void 0:f.match(u))==null?void 0:k[0])||"",_=h.value,l=w.filter(e=>{var t;return((t=e.url)==null?void 0:t.indexOf(d))!=-1}).map(({id:e})=>e);if(l.length){const e=await chrome.tabs.group({tabIds:l});await chrome.tabGroups.update(e,{title:_})}else W({message:"当前没有匹配的标签页",type:"warning"})},g=async()=>{let w={active:!0,currentWindow:!0},[b]=await chrome.tabs.query(w);return b};return(w,b)=>{const d=r("el-input"),_=r("el-button");return y(),V("div",Te,[s(d,{modelValue:N(a),"onUpdate:modelValue":b[0]||(b[0]=c=>E(a)?a.value=c:a=c),placeholder:"请输入域名",size:"small",clearable:""},null,8,["modelValue"]),s(d,{modelValue:N(h),"onUpdate:modelValue":b[1]||(b[1]=c=>E(h)?h.value=c:h=c),placeholder:"请输入分组名",size:"small",clearable:""},null,8,["modelValue"]),s(_,{type:"primary",size:"small",onClick:v},{default:i(()=>[O("生成该域名分组")]),_:1})])}}});const Ae=G(ze,[["__scopeId","data-v-d2696649"]]),Ee=U({__name:"index",setup(S){const u=C("first"),a=new RegExp("https://(.*?)/");let h=C([]),v=P([]),g=P({}),w=C([]);q(async()=>{h.value=await chrome.tabs.query({currentWindow:!0}),h.value.forEach(d=>{if(d.url){const _=d.url.match(a);_&&_&&v.push(_[0])}}),v=Array.from(new Set(v));for(const d of h.value)if(d.url){const _=d.url.match(a);if(_){const c=_==null?void 0:_[0];c&&v.includes(c)&&(g[c]?g[c].push(d):g[c]=[d])}}for(const d of Object.values(g))d.length>1&&w.value.push(d)});const b=(d,_)=>{console.log(d,_)};return(d,_)=>{const c=r("el-tab-pane"),l=r("el-tabs");return y(),z(l,{modelValue:u.value,"onUpdate:modelValue":_[0]||(_[0]=f=>u.value=f),class:"demo-tabs",type:"border-card",onTabClick:b},{default:i(()=>[s(c,{label:"快捷操作",name:"first"},{default:i(()=>[s(_e,{tabsList:N(h),groupArr:N(w)},null,8,["tabsList","groupArr"])]),_:1}),s(c,{label:"当前标签",name:"second"},{default:i(()=>[s(Ce,{tabsList:N(h),groupObj:N(g)},null,8,["tabsList","groupObj"])]),_:1}),s(c,{label:"快照记录",name:"third"},{default:i(()=>[s(Se)]),_:1}),s(c,{label:"自动匹配",name:"fourth"},{default:i(()=>[s(Ae)]),_:1})]),_:1},8,["modelValue"])}}});export{Ee as default};
