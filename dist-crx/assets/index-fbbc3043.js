import{d as q,r as N,o as M,a as u,b as x,c as $,e,w as n,f as O,u as R,i as E,F as Q,g as J,h as I,n as U,t as le,E as W,j as G,k as B,l as H,_ as F,m as T,p as ne,q as K,v as D,s as j,x as X,y as Y,z as P}from"./popup-60e99057.js";import"./modulepreload-polyfill-3cfb730f.js";const ce={class:"quick-operation-container"},ae={class:"form-box"},ie={class:"form-title"},re={class:"form-color"},ue={class:"color-box"},de=["onClick"],pe={class:"form-btn"},_e=q({__name:"QuickOperation",props:{tabsList:{type:Array,required:!0,default:[]},groupArr:{type:Array,required:!0,default:[]}},setup(L){const b=N([]),y=N(0),i=["grey","blue","red","yellow","green","pink","purple","cyan"];let p=N(""),_=N(!0);M(()=>{chrome.storage.sync.get(["isAuto"],function(m){_.value=m.isAuto})});const V=async()=>{chrome.runtime.sendMessage({action:"autoGroup"})},v=()=>{chrome.runtime.sendMessage({action:"cancelGroup"})},t=()=>{chrome.runtime.sendMessage({action:"closeGroup"})},s=()=>{chrome.storage.sync.set({isAuto:_.value},function(){})},c=m=>{y.value=m},C=async()=>{if(b.value.length>0){const m=le(b.value),k=p.value,h=await chrome.tabs.group({tabIds:m});await chrome.tabGroups.update(h,{title:k}),b.value=[],y.value=0}else W({message:"请勾选标签页~",type:"warning"})};return(m,k)=>{const h=u("el-button"),w=u("el-switch"),l=u("el-divider"),a=u("el-checkbox"),o=u("el-checkbox-group"),f=u("el-input"),z=u("el-popover");return x(),$("div",ce,[e(h,{type:"primary",size:"small",onClick:V},{default:n(()=>[O("一键生成分组")]),_:1}),e(h,{type:"primary",size:"small",onClick:v},{default:n(()=>[O("一键取消分组")]),_:1}),e(h,{type:"primary",size:"small",onClick:t},{default:n(()=>[O("一键关闭分组")]),_:1}),e(w,{modelValue:R(_),"onUpdate:modelValue":k[0]||(k[0]=r=>E(_)?_.value=r:_=r),size:"large","inline-prompt":"",style:{"--el-switch-on-color":"#13ce66","--el-switch-off-color":"#ff4949"},"active-text":"开启自动分组","inactive-text":"关闭自动分组",onChange:s},null,8,["modelValue"]),e(l,{direction:"horizontal","content-position":"left"},{default:n(()=>[O("当前窗口所有标签页")]),_:1}),e(o,{modelValue:b.value,"onUpdate:modelValue":k[1]||(k[1]=r=>b.value=r)},{default:n(()=>[(x(!0),$(Q,null,J(L.tabsList,r=>(x(),G(a,{key:r.id,label:r.id},{default:n(()=>[O(B(r.title),1)]),_:2},1032,["label"]))),128))]),_:1},8,["modelValue"]),I("div",ae,[I("div",ie,[e(f,{modelValue:R(p),"onUpdate:modelValue":k[2]||(k[2]=r=>E(p)?p.value=r:p=r),placeholder:"请输入分组名",size:"small",clearable:""},null,8,["modelValue"])]),I("div",re,[e(z,{placement:"bottom",width:230,trigger:"click"},{reference:n(()=>[I("div",{class:"color-check",style:U({backgroundColor:i[y.value]})},null,4)]),default:n(()=>[I("div",ue,[(x(),$(Q,null,J(i,(r,g)=>I("span",{key:r,style:U({backgroundColor:r}),class:H([g==y.value?"color-active":"","color-item"]),onClick:A=>c(g)},null,14,de)),64))])]),_:1})]),I("div",pe,[e(h,{type:"primary",size:"small",onClick:C},{default:n(()=>[O("生成分组")]),_:1})])])])}}});const me=F(_e,[["__scopeId","data-v-29746897"]]),he=L=>(X("data-v-369c535c"),L=L(),Y(),L),fe={class:"current-tabs-container"},ge=he(()=>I("div",{class:"title-h4"},"当前所有标签",-1)),ve={class:"custom-tree-node"},be={class:"node-left"},ye=["src"],ke=["onClick"],xe={class:"node-right"},Ce=q({__name:"CurrentTabs",props:{tabsList:Array,groupObj:Object},setup(L){const{tabsList:b,groupObj:y}=L;let i=N([]),p=N(0),_=N("");const V={children:"children",label:"title"};M(async()=>{console.log("currentTabs onMounted：",y,b),w()});const v=l=>{console.log(l),p.value=0,_.value="",l.isRootNode||chrome.tabs.update(l.id,{active:!0})},t=l=>{chrome.tabGroups.update(l.id,{title:l.title},()=>{p.value=0})},s=l=>{_.value=l.title||"未命名",p.value=l.id,l.isRootNode||chrome.tabs.update(l.id,{active:!0})},c=l=>{l.isRootNode&&(l.collapsed=!l.collapsed,chrome.tabGroups.update(l.groupId,{collapsed:l.collapsed}))},C=l=>{if(l.isRootNode)chrome.windows.create({focused:!0},a=>{l.children&&a&&(chrome.tabGroups.move(l.groupId,{windowId:a.id,index:-1}),chrome.tabs.query({windowId:a.id},o=>{var g;const f=(g=l.children)==null?void 0:g.map(A=>A.id),r=o.filter(A=>!f.includes(A.id)).map(A=>A.id);chrome.tabs.remove(r)}))});else{const a=l.id;chrome.windows.create({tabId:a})}w()},m=l=>{const a={url:"chrome://newtab/",active:!1};chrome.tabs.create(a,o=>{chrome.tabs.group({tabIds:o.id,groupId:l.groupId}),chrome.tabs.update(o.id,{active:!0})})},k=l=>{chrome.storage.sync.get(["snapshotLogList"],function(a){console.log("Value currently is "+a.snapshotLogList);let o=a.snapshotLogList?JSON.parse(a.snapshotLogList):[];o.push(l),chrome.storage.sync.set({snapshotLogList:JSON.stringify(o)},function(){console.log("Value is set to "+o)})})},h=(l,a)=>{const o=l.parent,f=o.data.children||o.data,z=f.findIndex(r=>r.id===a.id);f.splice(z,1),i.value=[...i.value],a.isRootNode?chrome.tabs.query({groupId:a.groupId},r=>{const g=r.map(A=>A.id);chrome.tabs.remove(g)}):chrome.tabs.remove(a.id)},w=()=>{i.value=[],chrome.tabs.query({currentWindow:!0},l=>{l.forEach(a=>{const o={id:a.id,title:a.title||"",url:a.url,favIconUrl:a.favIconUrl,groupId:a.groupId,index:a.index,children:[]};i.value.push(o)}),chrome.tabGroups.query({},a=>{i.value.forEach(o=>{const f=a.find(z=>z.id===o.groupId);f&&(o.groupName=f.title,o.color=f.color,o.collapsed=f.collapsed)}),a.forEach(o=>{const f=i.value.findIndex(g=>g.groupId==o.id),z=i.value.filter(g=>g.groupId==o.id);i.value=i.value.filter(g=>g.groupId!=o.id);const r={id:o.id,title:o.title||"",url:"",color:o.color,groupId:o.id,collapsed:o.collapsed,children:z,isRootNode:!0,isInput:!1};i.value.splice(f,0,r)}),console.log(i.value,"xxxx标签树🌲xxxx")})})};return(l,a)=>{const o=u("el-input"),f=u("Expand"),z=u("Fold"),r=u("el-icon"),g=u("el-tooltip"),A=u("TopRight"),Z=u("Plus"),ee=u("Camera"),oe=u("Close"),te=u("el-tree");return x(),$("div",fe,[ge,e(te,{data:R(i),props:V,"node-key":"id","default-expand-all":"",onNodeClick:v},{default:n(({node:se,data:d})=>[I("div",ve,[I("div",be,[d.favIconUrl?(x(),$("img",{key:0,src:d.favIconUrl,class:"icon-img"},null,8,ye)):(x(),$("span",{key:1,class:"icon-img",style:U({backgroundColor:d.color})},null,4)),d.isRootNode&&R(p)==d.id?(x(),G(o,{key:2,modelValue:d.title,"onUpdate:modelValue":S=>d.title=S,placeholder:"请输入标题",size:"small",style:{width:"200px"},onClick:T(()=>{},["stop"]),onKeydown:ne(S=>t(d),["enter"])},null,8,["modelValue","onUpdate:modelValue","onClick","onKeydown"])):(x(),$("span",{key:3,class:H(["title-box",{"group-title":d.isRootNode}]),style:U({fontWeight:d.isRootNode?600:400}),onClick:T(S=>s(d),["stop"])},B(d.title||"未命名"),15,ke))]),I("div",xe,[d.isRootNode?(x(),G(g,{key:0,class:"box-item",effect:"dark",content:"折叠|展开",placement:"top"},{default:n(()=>[e(r,{size:18,style:{"margin-right":"12px"},onClick:T(S=>c(d),["stop"])},{default:n(()=>[K(e(f,null,null,512),[[D,!d.collapsed]]),K(e(z,null,null,512),[[D,d.collapsed]])]),_:2},1032,["onClick"])]),_:2},1024)):j("",!0),e(g,{class:"box-item",effect:"dark",content:"移至新窗口",placement:"top"},{default:n(()=>[e(r,{size:18,style:{"margin-right":"12px"},onClick:T(S=>C(d),["stop"])},{default:n(()=>[e(A)]),_:2},1032,["onClick"])]),_:2},1024),d.isRootNode?(x(),G(g,{key:1,class:"box-item",effect:"dark",content:"添加新标签",placement:"top"},{default:n(()=>[e(r,{size:18,style:{"margin-right":"12px"},onClick:T(S=>m(d),["stop"])},{default:n(()=>[e(Z)]),_:2},1032,["onClick"])]),_:2},1024)):j("",!0),e(g,{class:"box-item",effect:"dark",content:"保存快照",placement:"top"},{default:n(()=>[e(r,{size:18,style:{"margin-right":"12px"},onClick:T(S=>k(d),["stop"])},{default:n(()=>[e(ee)]),_:2},1032,["onClick"])]),_:2},1024),e(g,{class:"box-item",effect:"dark",content:"关闭标签",placement:"top"},{default:n(()=>[e(r,{size:18,onClick:T(S=>h(se,d),["stop"])},{default:n(()=>[e(oe)]),_:2},1032,["onClick"])]),_:2},1024)])])]),_:1},8,["data"])])}}});const Ie=F(Ce,[["__scopeId","data-v-369c535c"]]),we=L=>(X("data-v-094513b5"),L=L(),Y(),L),Le={class:"current-tabs-container"},Ve=we(()=>I("div",null,"当前标签",-1)),Ne={class:"custom-tree-node"},Te={class:"node-left"},$e=["src"],Re={class:"node-right"},ze=q({__name:"SnapshotLog",setup(L){let b=P([]);const y={children:"children",label:"title"},i=t=>{console.log(t)},p=t=>{if(t.isRootNode)chrome.windows.create({focused:!0},s=>{t.children&&s&&(chrome.tabGroups.move(t.groupId,{windowId:s.id,index:-1}),chrome.tabs.query({windowId:s.id},c=>{var h;const C=(h=t.children)==null?void 0:h.map(w=>w.id),k=c.filter(w=>!C.includes(w.id)).map(w=>w.id);chrome.tabs.remove(k)}))});else{const s=t.id;chrome.windows.create({tabId:s})}},_=t=>{const s={url:"chrome://newtab/",active:!1};chrome.tabs.create(s,c=>{chrome.tabs.group({tabIds:c.id,groupId:t.groupId})})},V=t=>{console.log(t),chrome.storage.sync.get(["snapshotLogList"],function(s){console.log("Value currently is "+s.snapshotLogList);let c=s.snapshotLogList||[];console.log(c),c.push(t),chrome.storage.sync.set({snapshotLogList:c},function(){console.log("Value is set to "+c),b=s.snapshotLogList})})},v=(t,s)=>{console.log(t,s),s.isRootNode};return M(()=>{chrome.storage.sync.get(["snapshotLogList"],function(t){b=t.snapshotLogList?JSON.parse(t.snapshotLogList):[],console.log(b,"tabTree")})}),(t,s)=>{const c=u("TopRight"),C=u("el-icon"),m=u("el-tooltip"),k=u("Plus"),h=u("Camera"),w=u("Close"),l=u("el-tree");return x(),$("div",Le,[Ve,e(l,{data:R(b),props:y,"node-key":"id","default-expand-all":"",onNodeClick:i},{default:n(({node:a,data:o})=>[I("div",Ne,[I("div",Te,[o.favIconUrl?(x(),$("img",{key:0,src:o.favIconUrl,class:"icon-img"},null,8,$e)):(x(),$("span",{key:1,class:"icon-img",style:U({backgroundColor:o.color})},null,4)),I("span",{class:"title-box",style:U({fontWeight:o.isRootNode?600:400})},B(o.title),5)]),I("div",Re,[e(m,{class:"box-item",effect:"dark",content:"移至新窗口",placement:"top"},{default:n(()=>[e(C,{size:18,style:{"margin-right":"12px"},onClick:T(f=>p(o),["stop"])},{default:n(()=>[e(c)]),_:2},1032,["onClick"])]),_:2},1024),o.isRootNode?(x(),G(m,{key:0,class:"box-item",effect:"dark",content:"添加新标签",placement:"top"},{default:n(()=>[e(C,{size:18,style:{"margin-right":"12px"},onClick:T(f=>_(o),["stop"])},{default:n(()=>[e(k)]),_:2},1032,["onClick"])]),_:2},1024)):j("",!0),e(m,{class:"box-item",effect:"dark",content:"保存快照",placement:"top"},{default:n(()=>[e(C,{size:18,style:{"margin-right":"12px"},onClick:T(f=>V(o),["stop"])},{default:n(()=>[e(h)]),_:2},1032,["onClick"])]),_:2},1024),e(m,{class:"box-item",effect:"dark",content:"关闭标签",placement:"top"},{default:n(()=>[e(C,{size:18,onClick:T(f=>v(a,o),["stop"])},{default:n(()=>[e(w)]),_:2},1032,["onClick"])]),_:2},1024)])])]),_:1},8,["data"])])}}});const Ae=F(ze,[["__scopeId","data-v-094513b5"]]),Se=q({__name:"MatchingRule",setup(L){const b=new RegExp("https://(.*?)/");let y=N(""),i=N("");const p=async()=>{var m,k;const V=await chrome.tabs.query({currentWindow:!0}),v=await _(),t=y.value||((k=(m=v==null?void 0:v.url)==null?void 0:m.match(b))==null?void 0:k[0])||"",s=i.value,C=V.filter(h=>{var w;return((w=h.url)==null?void 0:w.indexOf(t))!=-1}).map(({id:h})=>h);if(C.length){const h=await chrome.tabs.group({tabIds:C});await chrome.tabGroups.update(h,{title:s})}else W({message:"当前没有匹配的标签页",type:"warning"})},_=async()=>{let V={active:!0,currentWindow:!0},[v]=await chrome.tabs.query(V);return v};return(V,v)=>{const t=u("el-input"),s=u("el-button");return x(),$("div",null,[e(t,{modelValue:R(y),"onUpdate:modelValue":v[0]||(v[0]=c=>E(y)?y.value=c:y=c),placeholder:"请输入域名",size:"small",clearable:""},null,8,["modelValue"]),e(t,{modelValue:R(i),"onUpdate:modelValue":v[1]||(v[1]=c=>E(i)?i.value=c:i=c),placeholder:"请输入分组名",size:"small",clearable:""},null,8,["modelValue"]),e(s,{type:"primary",size:"small",onClick:p},{default:n(()=>[O("生成该域名分组")]),_:1})])}}}),Ue=q({__name:"index",setup(L){const b=N("first"),y=new RegExp("https://(.*?)/");let i=N([]),p=P([]),_=P({}),V=N([]);M(async()=>{i.value=await chrome.tabs.query({currentWindow:!0}),i.value.forEach(t=>{if(t.url){const s=t.url.match(y);s&&s&&p.push(s[0])}}),p=Array.from(new Set(p));for(const t of i.value)if(t.url){const s=t.url.match(y);if(s){const c=s==null?void 0:s[0];c&&p.includes(c)&&(_[c]?_[c].push(t):_[c]=[t])}}for(const t of Object.values(_))t.length>1&&V.value.push(t);console.log("存在同域名可生成分组：",i.value,V.value,_,p)});const v=(t,s)=>{console.log(t,s)};return(t,s)=>{const c=u("el-tab-pane"),C=u("el-tabs");return x(),G(C,{modelValue:b.value,"onUpdate:modelValue":s[0]||(s[0]=m=>b.value=m),class:"demo-tabs",type:"border-card",onTabClick:v},{default:n(()=>[e(c,{label:"快捷操作",name:"first"},{default:n(()=>[e(me,{tabsList:R(i),groupArr:R(V)},null,8,["tabsList","groupArr"])]),_:1}),e(c,{label:"当前标签",name:"second"},{default:n(()=>[e(Ie,{tabsList:R(i),groupObj:R(_)},null,8,["tabsList","groupObj"])]),_:1}),e(c,{label:"快照记录",name:"third"},{default:n(()=>[e(Ae)]),_:1}),e(c,{label:"自动匹配",name:"fourth"},{default:n(()=>[e(Se)]),_:1})]),_:1},8,["modelValue"])}}});export{Ue as default};
